import Layout from 'lib/components/layout'
import { Link, Display, Image, Code } from '@zeit-ui/react'

export const meta = {
  title: 'SSR + è·³æ¿æ­å»ºè®°å½•',
  date: '2018-01-03T22:11:01.957Z',
  description: '',
}


é‰´äºæˆ‘çš„ ss æœåŠ¡å•†æ€»æ˜¯å¸¦ç€ç§Ÿé‡‘è·‘è·¯ï¼Œæˆ‘å†³å®šæ­å»ºä¸€ä¸ª ss æœåŠ¡å™¨ï¼Œè€ƒè™‘åˆ°æˆ‘æ­£åœ¨ä½¿ç”¨å’Œç”µè¯æ‹¨å·é€Ÿåº¦ç›¸å½“çš„é•¿åŸå®½å¸¦ï¼Œ
è¿˜éœ€è¦æ¶è®¾ä¸€ä¸ªå›½å†…æœåŠ¡å™¨ç”¨äºè·³æ¿ï¼Œé¢„ç®—çº¦æ˜¯ ss æœåŠ¡å™¨ 2.5$ ï¼Œè·³æ¿æœåŠ¡å™¨ 5$ ã€‚
ä½ å¯ä»¥é€šè¿‡æˆ‘çš„ <Link rel="nofollow" href="https://www.vultr.com/?ref=7213278">é‚€è¯·é“¾æ¥</Link> è´­ä¹°æœåŠ¡å™¨ï¼Œæˆ‘ä¼šå¾—åˆ°é¢å¤–çš„å¥–åŠ±ã€‚


> å¦‚æœä½ çš„ç½‘ç»œæœåŠ¡æä¾›å•†æ²¡æœ‰å±è”½ ss æœåŠ¡å™¨çš„ IP æˆ–ç«¯å£ï¼Œå®Œå…¨å¯ä»¥è·³è¿‡è·³æ¿ã€‚

### ç¯å¢ƒ
æˆ‘åœ¨ <Link rel="nofollow" href="https://www.vultr.com/?ref=7213278">vultr</Link> è´­ä¹° 2.5$ ä¸€ä¸ªæœˆçš„æœåŠ¡å™¨ï¼Œä¸è¢«å¹²æ‰°å¯ä»¥æ­£å¸¸æµè§ˆ 1080P youtube ï¼Œå¦‚æœä½ éœ€è¦æ¯å¤©çœ‹ twitch è¿™ç±»ç›´æ’­ï¼Œå¯èƒ½éœ€è¦ 5$ æˆ–æ›´å¥½çš„æœåŠ¡å™¨ã€‚

å…ˆåˆ›å»ºä¸€ä¸ªç”¨æˆ·ç”¨äºæ—¥å¸¸çš„ç™»å½•ï¼š

```shell
useradd {name}
passwd {name}
```

ç»™æ–°ç”¨æˆ·åŠ ä¸Š sudo æƒé™ï¼š`sudo vi /etc/sudoers`

```shell
root    ALL=(ALL)     ALL
{name}    ALL=(ALL)    ALL    # add
```

### æœåŠ¡ç«¯

ç”¨è„šæœ¬å®‰è£… SSR ï¼š
```bash
# install
wget -N --no-check-certificate https://raw.githubusercontent.com/91yun/shadowsocks_install/master/shadowsocksR.sh && bash shadowsocksR.sh

# commander
/etc/init.d/shadowsocks {start/stop/restart/status}

# show log
cat /var/log/shadowsocks.log

# update
cd /usr/local/shadowsocks/shadowsocks && gl

# uninstall
./shadowsocksR.sh uninstall
```

é»˜è®¤çš„é…ç½®åœ¨ `/etc/shadowsocks.json` ï¼Œå¦‚æœä½ å¸Œæœ›å¤šç”¨æˆ·ç™»å½•ï¼Œå¯ä»¥åˆ é™¤åŸæœ‰çš„å¸å·å¯†ç ï¼Œåœ¨é…ç½®æ–‡ä»¶ä¸­å¢åŠ 
ç«¯å£å¯¹äºå¯†ç çš„é”®å€¼å¯¹ã€‚ï¼ˆè®°å¾—è¿™æ˜¯ä¸ª JSON æ–‡ä»¶ï¼Œä¸è¦æœ‰è¯­æ³•é”™è¯¯ï¼‰

```bash
# close firewalld
sudo systemctl stop firewalld.service

# edit config
vi /etc/shadowsocks.json
```
```json
{
  "server": "0.0.0.0",
  "local_address": "127.0.0.1",
  "local_port": 1080,
  "port_password": {
    "3000": "123456"
  },
  "...other config": ""
}
```


å¦‚æœä½ æƒ³è¦ä½¿ç”¨ `V2Ray`, ä½ å¯ä»¥åœ¨æœåŠ¡ç«¯ä¸Šå…ˆè®¾å®š <Link color rel="nofollow" href="https://github.com/unix/want">want</Link>ï¼Œç„¶åé€šè¿‡ want ä¸€é”®å®‰è£…ã€‚

<Display caption={<p><Code>want</Code> å¯ä»¥åœ¨çº¿è¿è¡Œæ›´äººæ€§åŒ–çš„å‘½ä»¤</p>}>
  <Image width="600" height="300" src="/assets/want.webp" />
</Display>

<Display caption={<p><Code>want</Code> çš„ä¸€é”®è¿ç»´</p>}>
  <Code darkBash>want install v2ray</Code>
</Display>

### å®¢æˆ·ç«¯ SSR
è™½ç„¶ SSR è„šæœ¬èƒ½å¤Ÿå¿«é€Ÿç”Ÿæˆä¸€ä¸ªæœåŠ¡ç«¯ï¼Œä½†ä¸å…·å¤‡æµé‡æ§åˆ¶æŸ¥è¯¢ï¼Œä¹Ÿæ²¡æœ‰å¯è§†åŒ–çª—å£ï¼Œå¦‚æœä½ éœ€è¦è¿™äº›ï¼Œ
å¯ä»¥æ ¹æ®ä¸‹é¢çš„é…ç½®åœ¨æœåŠ¡å™¨ä¸Šå®‰è£…ä¸€ä¸ªå®¢æˆ·ç«¯ã€‚å°±æ˜¯ä½ å¸¸è§çš„é‚£äº›é»‘å¿ƒå•†äººçš„ç½‘ç«™äº† ğŸ¤”

```bash
## install docker and docker-compose
...

# run compose
wget https://raw.githubusercontent.com/orvice/ss-panel/master/docker-compose.yml
docker-compose up -d

# install ss-go
go get shadowsocks/shadowsocks-go/cmd/shadowsocks-server

```


### è·³æ¿
å¯ä»¥é€‰æ‹©è‡ªå·±ç”¨å›½å†…çš„æœåŠ¡å™¨æ­è®¾ä¸€ä¸ªè·³æ¿ï¼Œè½¬å‘ tcp/udp åˆ° vultr æœåŠ¡å™¨ï¼Œæˆ–è€…æ˜¯ç›´æ¥ä½¿ç”¨ä¸“ä¸šçš„ç½‘ç»œé“¾è·¯ä»£ç†ã€‚


#### åˆ©ç”¨ `haproxy` å®ç°èµ„æºè½¬å‘ï¼š

```bash
apt-get install haproxy
sudo vi /etc/haproxy/haproxy.cfg
```

åœ¨ `/etc/haproxy/haproxy.cfg` ä¸­ç¼–è¾‘:

```
global
        ulimit-n  51200

defaults
        log	global
        mode	tcp
        option	dontlognull
        contimeout 1000
        clitimeout 150000
        srvtimeout 150000

frontend app
        bind *: {PORT}
        default_backend ss-out

backend app
        server server1 {VULTR_IP:PORT} maxconn 20480
```

è¿è¡Œ `haproxy -f /etc/haproxy/haproxy.cfg` .

å…¶ä»–å‘½ä»¤:
```
# åœæ­¢
sudo systemctl stop haproxy.service
# æŸ¥çœ‹çŠ¶æ€
sudo systemctl status haproxy.service
# å¯åŠ¨
sudo systemctl start haproxy.service

# å¦‚æœä½ ä¸æ˜¯ centOS 7, å¯ä»¥ä½¿ç”¨
service haproxy start/stop/restart
```

#### ä¸“ä¸šçš„ä»£ç†æä¾›å•†

ä½ å¯ä»¥ä½¿ç”¨ [VLink](https://vnet.link/?rc=52957) è´­ä¹°ä¸“ä¸šçš„é“¾è·¯çº§ç½‘ç»œä¼˜åŒ–ã€‚

ç•¥è´µï¼Œä¸è¿‡ä¼˜åŒ–æ¯”è¾ƒå¥½ï¼Œæ¯”æ‰‹åŠ¨åœ¨å›½å†…æ­è·³æ¿ä¼šæ›´å¿«ä¸€äº›ã€‚


export default ({ children }) => <Layout meta={meta}>{children}</Layout>
